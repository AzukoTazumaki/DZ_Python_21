{% block update_player %}
<div class="row d-flex align-items-center justify-content-between code_description mt-4">
    <div class="col-3">
        <h5>Метод изменения данных</h5>
        <hr>
        <p>
            Метод <span class="help_translate">update()</span> выполняет функцию 
            обновления данных выбранного игрока. Я старался сделать его короче, но 
            это максимум, что у меня получилось. Здесь распаковывается словарь на те 
            же 8 составляющих за исключением одного: добавился ID. Так как в коде у нас  
            начальный индекс 0, а в HTML отсчет строк в таблице начинается с 1, отнимаем 
            от пришедшего ID единицу, предварительно переведя его в число. Распакованные 
            элементы кроме ID добавляем в новый список, который отравляем в уже известный 
            метод <span class="help_translate">check_unknown_fields()</span>, откуда сразу 
            получаем отформатированный список. Проверяем, что ID находится в диапазоне 
            границ номеров строк таблицы. Если проверка успешна, с помощью метода Pandas 
            <span class="help_translate">loc</span>, в который передаем ID (номер строки), 
            меняем для каждого столбца значение, которое получили из форм, иначе возвращаем 
            строку с ошибкой. Если значение равно 
            строке <span class="help_translate">"Неизвестно"</span>, тогда не меняем ячейку.
            В конце возвращаем вызов метода <span class="help_translate">read_csv_to_html()</span>.
        </p>
    </div>
    <div class="col-9">
        <div class="highlight" style="background: #fdf6e3; border-radius: 8px;border: 1px solid grey;padding: 15px"><pre style="line-height: 125%;"><span></span>
<span style="color: #859900">def</span> <span style="color: #268bd2">update</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">):</span> 
    <span style="color: #657b83">update_id:</span> <span style="color: #268bd2">int</span> <span style="color: #93a1a1">=</span> <span style="color: #268bd2">int</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">form_info[</span><span style="color: #2aa198">&#39;player_id_update&#39;</span><span style="color: #657b83">])</span> <span style="color: #93a1a1">-</span> <span style="color: #2aa198">1</span> 
    <span style="color: #657b83">full_name:</span> <span style="color: #268bd2">str</span> <span style="color: #93a1a1">=</span> \ 
        <span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">form_info[</span><span style="color: #2aa198">&#39;player_first_name&#39;</span><span style="color: #657b83">]</span><span style="color: #93a1a1">.</span><span style="color: #657b83">capitalize()</span> <span style="color: #93a1a1">+</span> <span style="color: #2aa198">&#39; &#39;</span> <span style="color: #93a1a1">+</span> \ 
        <span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">form_info[</span><span style="color: #2aa198">&#39;player_last_name&#39;</span><span style="color: #657b83">]</span><span style="color: #93a1a1">.</span><span style="color: #657b83">capitalize()</span> <span style="color: #93a1a1">+</span> <span style="color: #2aa198">&#39; &#39;</span> <span style="color: #93a1a1">+</span> \ 
        <span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">form_info[</span><span style="color: #2aa198">&#39;player_surname&#39;</span><span style="color: #657b83">]</span><span style="color: #93a1a1">.</span><span style="color: #657b83">capitalize()</span> 
    <span style="color: #657b83">position:</span> <span style="color: #268bd2">str</span> <span style="color: #93a1a1">=</span> <span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">form_info[</span><span style="color: #2aa198">&#39;player_role&#39;</span><span style="color: #657b83">]</span><span style="color: #93a1a1">.</span><span style="color: #657b83">capitalize()</span> 
    <span style="color: #657b83">age:</span> <span style="color: #268bd2">str</span> <span style="color: #93a1a1">=</span> <span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">form_info[</span><span style="color: #2aa198">&#39;player_age&#39;</span><span style="color: #657b83">]</span> 
    <span style="color: #657b83">height:</span> <span style="color: #268bd2">str</span> <span style="color: #93a1a1">=</span> <span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">form_info[</span><span style="color: #2aa198">&#39;player_height&#39;</span><span style="color: #657b83">]</span> 
    <span style="color: #657b83">weight:</span> <span style="color: #268bd2">str</span> <span style="color: #93a1a1">=</span> <span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">form_info[</span><span style="color: #2aa198">&#39;player_weight&#39;</span><span style="color: #657b83">]</span> 
    <span style="color: #657b83">team:</span> <span style="color: #268bd2">str</span> <span style="color: #93a1a1">=</span> <span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">form_info[</span><span style="color: #2aa198">&#39;player_team&#39;</span><span style="color: #657b83">]</span> 
    <span style="color: #657b83">education:</span> <span style="color: #268bd2">str</span> <span style="color: #93a1a1">=</span> <span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">form_info[</span><span style="color: #2aa198">&#39;player_education&#39;</span><span style="color: #657b83">]</span> 
    <span style="color: #657b83">salary:</span> <span style="color: #268bd2">str</span> <span style="color: #93a1a1">=</span> <span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">form_info[</span><span style="color: #2aa198">&#39;player_salary&#39;</span><span style="color: #657b83">]</span> 
    <span style="color: #657b83">player_new_info:</span> <span style="color: #268bd2">list</span> <span style="color: #93a1a1">=</span> <span style="color: #657b83">[</span> 
        <span style="color: #657b83">full_name,</span> <span style="color: #657b83">position,</span> <span style="color: #657b83">age,</span> <span style="color: #657b83">height,</span> 
        <span style="color: #657b83">weight,</span> <span style="color: #657b83">team,</span> <span style="color: #657b83">education,</span> <span style="color: #657b83">salary</span> 
    <span style="color: #657b83">]</span> 
    <span style="color: #657b83">checked_player_new_info:</span> <span style="color: #268bd2">list</span> <span style="color: #93a1a1">=</span> <span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">check_unknown_fields(player_new_info)</span> 
    <span style="color: #657b83">file</span> <span style="color: #93a1a1">=</span> <span style="color: #657b83">pd</span><span style="color: #93a1a1">.</span><span style="color: #657b83">read_csv(</span><span style="color: #2aa198">&#39;results/players.csv&#39;</span><span style="color: #657b83">)</span> 
    <span style="color: #859900">if</span> <span style="color: #2aa198">1</span> <span style="color: #93a1a1">&lt;</span> <span style="color: #657b83">update_id</span> <span style="color: #93a1a1">&lt;</span> <span style="color: #268bd2">len</span><span style="color: #657b83">(file[</span><span style="color: #2aa198">&#39;Name&#39;</span><span style="color: #657b83">]):</span> 
        <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Name&#39;</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">=</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">0</span><span style="color: #657b83">]</span> <span style="color: #859900">if</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">0</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">!=</span> <span style="color: #2aa198">&#39;Неизвестно&#39;</span> <span style="color: #859900">else</span> <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Name&#39;</span><span style="color: #657b83">]</span> 
        <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Position&#39;</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">=</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">1</span><span style="color: #657b83">]</span> <span style="color: #859900">if</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">1</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">!=</span> <span style="color: #2aa198">&#39;Неизвестно&#39;</span> <span style="color: #859900">else</span> <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Position&#39;</span><span style="color: #657b83">]</span> 
        <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Age&#39;</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">=</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">2</span><span style="color: #657b83">]</span> <span style="color: #859900">if</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">2</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">!=</span> <span style="color: #2aa198">&#39;Неизвестно&#39;</span> <span style="color: #859900">else</span> <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Age&#39;</span><span style="color: #657b83">]</span> 
        <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Height&#39;</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">=</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">3</span><span style="color: #657b83">]</span> <span style="color: #859900">if</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">3</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">!=</span> <span style="color: #2aa198">&#39;Неизвестно&#39;</span> <span style="color: #859900">else</span> <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Height&#39;</span><span style="color: #657b83">]</span> 
        <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Weight&#39;</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">=</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">4</span><span style="color: #657b83">]</span> <span style="color: #859900">if</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">4</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">!=</span> <span style="color: #2aa198">&#39;Неизвестно&#39;</span> <span style="color: #859900">else</span> <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Weight&#39;</span><span style="color: #657b83">]</span> 
        <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Team&#39;</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">=</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">5</span><span style="color: #657b83">]</span> <span style="color: #859900">if</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">5</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">!=</span> <span style="color: #2aa198">&#39;Неизвестно&#39;</span> <span style="color: #859900">else</span> <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Team&#39;</span><span style="color: #657b83">]</span> 
        <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;College&#39;</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">=</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">6</span><span style="color: #657b83">]</span> <span style="color: #859900">if</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">6</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">!=</span> <span style="color: #2aa198">&#39;Неизвестно&#39;</span> <span style="color: #859900">else</span> <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;College&#39;</span><span style="color: #657b83">]</span> 
        <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Salary&#39;</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">=</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">7</span><span style="color: #657b83">]</span> <span style="color: #859900">if</span> <span style="color: #657b83">checked_player_new_info[</span><span style="color: #2aa198">7</span><span style="color: #657b83">]</span> <span style="color: #93a1a1">!=</span> <span style="color: #2aa198">&#39;Неизвестно&#39;</span> <span style="color: #859900">else</span> <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">loc[update_id,</span> <span style="color: #2aa198">&#39;Salary&#39;</span><span style="color: #657b83">]</span> 
        <span style="color: #657b83">file</span><span style="color: #93a1a1">.</span><span style="color: #657b83">to_csv(</span><span style="color: #2aa198">&#39;results/players.csv&#39;</span><span style="color: #657b83">,</span> <span style="color: #657b83">index</span><span style="color: #93a1a1">=</span><span style="color: #2aa198">False</span><span style="color: #657b83">,</span> <span style="color: #657b83">mode</span><span style="color: #93a1a1">=</span><span style="color: #2aa198">&#39;w&#39;</span><span style="color: #657b83">)</span> 
    <span style="color: #859900">return</span> <span style="color: #268bd2">self</span><span style="color: #93a1a1">.</span><span style="color: #657b83">read_csv_to_html()</span> <span style="color: #859900">return</span> <span style="color: #2aa198">&#39;Введенный ID недопустим. Вы ввели ID за пределами границ таблицы.&#39;</span></pre>
        </div>
    </div>
</div>
{% endblock %}